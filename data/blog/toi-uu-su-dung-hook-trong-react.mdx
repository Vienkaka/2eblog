---
title: 'Tá»‘i Æ°u sá»­ dá»¥ng Hooks trong React'
thumnail: 'https://fastly.picsum.photos/id/244/4288/2848.jpg?hmac=R6j9PBP4aBk2vcEIoOPU4R_nuknizryn2Vq8GGtWTrM'
date: '2023-06-06'
lastmod: '2023-06-06'
tags: ['reactjs', 'hooks', 'optimization', 'frontend', 'javascript', 'tips']
draft: false
summary: 'Xin chÃ o cÃ¡c báº¡n, tiáº¿p tá»¥c series vá» React thÃ¬ hÃ´m nay mÃ¬nh xin chia sáº» vá» cÃ¡ch sá»­ dá»¥ng tá»‘i Æ°u cÃ¡c hooks trong React. ThÃ¬ React hooks Ä‘Æ°á»£c release vÃ o phiÃªn báº£n v16. 8.0 cÃ¡ch Ä‘Ã¢y cÅ©ng Ä‘Æ°á»£c 4 nÄƒm rá»“i, khi react hooks ra Ä‘á»i thÃ¬ Ä‘Ã£ lÃ m thay Ä‘á»•i tÆ° duy láº­p trÃ¬nh cá»§a cÃ¡c láº­p trÃ¬nh viÃªn. VÃ  hÃ´m nay mÃ¬nh muá»‘n nÃ³i vá» viá»‡c chuyá»ƒn Ä‘á»•i tá»« class component sang function components + hooks'
images:
  [
    'https://fastly.picsum.photos/id/244/4288/2848.jpg?hmac=R6j9PBP4aBk2vcEIoOPU4R_nuknizryn2Vq8GGtWTrM',
  ]
authors: ['default']
layout: PostLayout
canonicalUrl: https://gaoden.vercel.app/blog/toi-uu-su-dung-hook-trong-react
---

<TOCInline toc={props.toc} toHeading={(2, 3)} />

Xin chÃ o cÃ¡c báº¡n, tiáº¿p tá»¥c series vá» React thÃ¬ hÃ´m nay mÃ¬nh xin chia sáº» vá» cÃ¡ch sá»­ dá»¥ng tá»‘i Æ°u cÃ¡c hooks trong React. ThÃ¬ React hooks Ä‘Æ°á»£c release vÃ o phiÃªn báº£n v16. 8.0 cÃ¡ch Ä‘Ã¢y cÅ©ng Ä‘Æ°á»£c 4 nÄƒm rá»“i, khi react hooks ra Ä‘á»i thÃ¬ Ä‘Ã£ lÃ m thay Ä‘á»•i tÆ° duy láº­p trÃ¬nh cá»§a cÃ¡c láº­p trÃ¬nh viÃªn. VÃ  hÃ´m nay mÃ¬nh muá»‘n nÃ³i vá» viá»‡c chuyá»ƒn Ä‘á»•i tá»« class component sang function components + hooks

## VÃ²ng Ä‘á»i

### Class component

```javascript
class Chart extends Component {
  componentDidMount() {
    // khi Ä‘Ã£ mount Chart
  }
  componentDidUpdate(prevProps) {
    if (prevProps.data == props.data) return
    // khi update dá»¯ liá»‡u
  }
  componentWillUnmount() {
    // trÆ°á»›c khi unmount Chart
  }
  render() {
    return <svg className="Chart" />
  }
}
```

### Function component

```javascript
const Chart = ({ data }) => {
  useEffect(() => {
    // khi mount Chart hoáº·c update dá»¯ liá»‡u
    return () => {
      // khi update dá»¯ liá»‡u
      // trÆ°á»›c khi unmount chart
    }
  }, [data])
  return <svg className="Chart" />
}
```

## Cáº­p nháº­t dá»¯ liá»‡u

Sá»­ dá»¥ng useEffect Ä‘á»ƒ náº¯m báº¯t vÃ²ng Ä‘á»i cá»§a React.
CÃ³ pháº£i báº¡n Ä‘ang suy nghÄ© useEffect tháº­t lÃ  vi diÃªu khÃ´ng?ğŸ˜ƒğŸ˜ƒğŸ˜ƒ. NhÆ°ng mÃ  chÆ°a Ä‘Ã¢u tháº­t sá»± useEffect khÃ´ng pháº£i lÃ  hook Ä‘á»ƒ giáº£i quyáº¿t má»i váº¥n Ä‘á». HÃ£y cÃ¹ng mÃ¬nh tÃ¬m hiá»ƒu tiáº¿p nhÃ¡.
BÃ¢y giá» hÃ£y xem má»™t vÃ­ dá»¥ khÃ¡c biá»‡t lÃ  muá»‘n tÃ­nh toÃ¡n dá»¯ liá»‡u báº±ng hÃ m getDataWithinRange.

### Class component

```javascript
class Chart extends Component {
  state = {
    data: null,
  }
  componentDidMount() {
    const newData = getDataWithinRange(this.props.dateRange)
    this.setState({ data: newData })
  }
  componentDidUpdate(prevProps) {
    if (prevProps.dateRange != this.props.dateRange) {
      const newData = getDataWithinRange(this.props.dateRange)
      this.setState({ data: newData })
    }
  }
  render() {
    return <svg className="Chart" />
  }
}
```

### Function component

```javascript
const Chart = ({ dateRange }) => {
  const [data, setData] = useState()
  useEffect(() => {
    const newData = getDataWithinRange(dateRange)
    setData(newData)
  }, [dateRange])
  return <svg className="Chart" />
}
```

useEffect Ä‘ang cáº­p nháº­t data dá»±a vÃ o sá»± thay Ä‘á»•i cá»§a dateRange => khi prop dateRange thay Ä‘á»•i thÃ¬ useEffect Ä‘Æ°á»£c kÃ­ch hoáº¡t vÃ  tÃ­nh toÃ¡n newData báº±ng function getDataWithinRange sau Ä‘Ã³ cáº­p nháº­t láº¡i dá»¯ liá»‡u báº±ng hook setData.
Thay vÃ¬ sá»­ dá»¥ng 2 hook useEffect vÃ  useStatet thÃ¬ ta cÃ³ thá»ƒ tá»‘i Æ°u báº±ng hook useMemo

```javascript
const Chart = ({ dateRange }) => {
  const data = useMemo(() => getDataWithinRange(dateRange), [dateRange])
  return <svg className="Chart" />
}
```

DÆ°á»›i Ä‘Ã¢y lÃ  1 vÃ­ dá»¥ tháº¥y sá»± tá»‘i Æ°u rÃµ rá»‡t vá» code giá»¯a class component vÃ  function component

## VÃ­ dá»¥

### Class component

```javascript
class Chart extends Component {
  state = {
    data: null,
    dimensions: null,
    xScale: null,
    yScale: null,
  }
  componentDidMount() {
    const newData = getDataWithinRange(this.props.dateRange)
    this.setState({ data: newData })
    this.setState({ dimensions: getDimensions() })
    this.setState({ xScale: getXScale() })
    this.setState({ yScale: getYScale() })
  }
  componentDidUpdate(prevProps, prevState) {
    if (prevProps.dateRange != this.props.dateRange) {
      const newData = getDataWithinRange(this.props.dateRange)
      this.setState({ data: newData })
    }
    if (prevProps.margins != this.props.margins) {
      this.setState({ dimensions: getDimensions() })
    }
    if (prevState.data != this.state.data) {
      this.setState({ xScale: getXScale() })
      this.setState({ yScale: getYScale() })
    }
  }
  render() {
    return <svg className="Chart" />
  }
}
```

### Function component

```javascript
const Chart = ({ dateRange, margins }) => {
  const data = useMemo(() => getDataWithinRange(dateRange), [dateRange])
  const dimensions = useMemo(getDimensions, [margins])
  const xScale = useMemo(getXScale, [data])
  const yScale = useMemo(getYScale, [data])
  return <svg className="Chart" />
}
```

NhÆ° vÃ­ dá»¥ trÃªn class component pháº£i quáº£n lÃ½ quÃ¡n nhiá»u state, trong khi function component thÃ¬ chá»‰ cáº§n giÃ¡ trá»‹ cá»§a biáº¿n Ä‘áº§u ra. MÃ£ ngáº¯n hÆ¡n chÆ°a cháº¯c lÃ  dá»… Ä‘á»c hÆ¡n nhÆ°ng cháº¯c cháº¯n viá»‡c quáº£n lÃ½ state sáº½ dá»… dÃ ng hÆ¡n. VÃ  thÆ°á»ng thÃ¬ cÃ¡c Ä‘oáº¡n mÃ£ trong function component cá»§a chÃºng tÃ´i ngáº¯n hÆ¡n trong class component lÃ  tá»« 46% Ä‘áº¿n 50%

### Lá»i káº¿t

NhÆ° váº­y lÃ  mÃ¬nh cÃ¹ng cÃ¡c báº¡n Ä‘Ã£ Ä‘i qua vÃ²ng Ä‘á»i cá»§a React Ä‘á»ƒ biáº¿t sá»± khÃ¡c biá»‡t cá»§a class component vÃ  function component, cÅ©ng nhÆ° tÃ¬m hiá»ƒu useMemo Ä‘á»ƒ quáº£n lÃ½ state trong React. Hy vá»ng cÃ¡c báº¡n sáº½ cÃ³ thÃªm nhá»¯ng kiáº¿n thá»©c giÃºp tá»‘i Æ°u code vÃ  maintain dá»… dÃ ng hÆ¡n vá» sau. ChÃºc cÃ¡c báº¡n cÃ³ 1 ngÃ y lÃ m viá»‡c hiá»‡u quáº£.
